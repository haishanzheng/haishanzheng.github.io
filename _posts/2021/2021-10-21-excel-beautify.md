---
title:  "给Excel文件点颜色"
date:   2021-10-21 16:23:12 +0800
---

## 前言

未来还会有姐妹篇Word，我会谈到大纲视图、样式，谈到“显示所有格式标记”，如果有“显示源代码”，我也会谈到。

我不怎么会用Excel，我用Python，用Jupyter Notebooks，用Dash。所以我没有点Excel技能树，我甚至无法随心所欲拉出一个透视图。其实Excel简单易用，有非常广的群众基础，然而正因为其过分简单，很多人，只用到了1%的功能，如何再进一步？Don’t Make Me Think。下面我举3个例子，抛砖引玉。

![](/images/2021/excel/donot-make-me-think.jpg)

> 作者是（美）克鲁格。本书适合从事Web设计和Web开发的技术人员阅读，特别适合为如何留住访问者苦恼的网站/网页设计人员阅读。可用性设计是Web设计中最重要也是难度最大的一项任务。本书作者根据多年从业的经验，剖析用户的心理，在用户使用模式、为扫描进行设计、导航设计、主页布局、可用性测试等方面提出了许多独特的观点，并给出了大量简单、易行的可用性设计的建议。本书短小精练，语言轻松诙谐，书中穿插大量色彩丰富的屏幕截图、趣味丛生的卡通插图以及包含大量信息的图表，使枯燥的设计原理变得平易近人。

## 例子1：在线课程平台网络保障报表

疫情期间，“停课不停学”，线上线下一体化上课，有些学生在校内，要访问校内课程平台和校外视频会议网站，有些学生在校外，要访问校内课程平台，保障部门需要了解校内课程平台和网络流量状况。于是有了下面的Excel（数据都是假的，编的好辛苦）：

![](/images/2021/excel/course1.png)

但是对于数字不敏感的人，或者不熟悉带宽情况的，这些数字看起来意义不大，需要很多口舌，为什么不让数字自己说话？

Excel有条件格式。

> 使用条件格式可以帮助你直观地查看和分析数据、发现关键问题以及识别模式和趋势。
>
> 采用条件格式易于达到以下效果：突出显示所关注的单元格或单元格区域；强调异常值；使用数据栏、色阶和图标集（与数据中的特定变体对应）直观地显示数据。

官方例子1：

![](/images/2021/excel/conditional-formating1.png)

官方例子2：

![](/images/2021/excel/conditional-formating2.png)

于是使用条件格式对上面图进行改造，成为：

![](/images/2021/excel/course2.png)

从这个图就可以清晰识别出一些模式，比如，绿色的带宽情况，说明带宽还是足够的，1月2日和1月3日是周末，所以各项数值下降也算正常。也可以看出周一比周五明显用户量比较大。

## 例子2：班级报体温

疫情期间，很多学校，为了精准掌握师生健康状况，都推出了在线报体温和身体状况的表单。大家各显神通，有些人通过钉钉，有些人接龙，有些有自己的平台，有些，就直接使用在线Excel表格，比如：

![](/images/2021/excel/bt1.png)

这个Excel，简单粗暴，好用，但是，能不能做得更好？

对于家长而言，今天是哪天？我应该填在哪个格子。我填写的时候，手机屏幕比较小，往右拉都看不到小宝的名字了。

**Don’t Make Me Think**，解决办法

1. 加入条件格式，如果是当天，格子绿色底显眼。
1. 冻结窗格到C3。

对于老师关注什么？哪个小朋友体温过高？有多少人没有填报？有谁乱填报？

**Don’t Make Me Think**，解决办法

1. 条件格式，如果是空值，则底色黄，突出显示。
1. 条件格式，体温>37.3，红色粗体字。
1. 加入未填报合计数行，公式=COUNTIF(C3:C20,"")
1. 加入标准差，=ROUND(STDEV.P(C3:O3), 2)，标准差都是0，是鼠标拉出来的吧？

截图如下：

![](/images/2021/excel/bt2.png)

## 例子3：任务分解表

有时候我们领到一个大任务，这个任务参与部门很多，于是会做类似下面的一个表格，当然真实情况比这个复杂很多，会有几十个任务，十几个部门。

![](/images/2021/excel/task1.png)

这个表格没有什么大问题，开会讨论牵头部门和牵涉团队，领任务，编辑。但是，最后拿到这个表格的团队，他很难进行筛选到底我需要负责哪些项目。

如果这个团队，不是写的，而是点击自动选出来的呢？

于是就有了下面这个表格：

![](/images/2021/excel/task2.png)

在右侧团队输入2就是牵头部门，1就是参与部门。团队名字不会写错，还方便过滤，统计。使用公式

```vb
=TEXTJOIN(" ",TRUE,IF(E2:M2,$E$1:$M$1,""))
```

当然，缺点是，这个表格会拉得很宽，那就设置一下打印区域。

有好的思路再告诉我。
